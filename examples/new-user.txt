$ user=test-new-user-`date "+%Y%m%d-%H%M%S"`
$
$ alias curl='curl -sw "%{http_code}\n"'
$ alias display='grep -E "(<h.>|help-block|^[0-9]+$)" | sed -e "s/<[^>]*>//g"; echo'
$
$ curl -XGET udge/new-user | display
New user
200

$ curl -XPOST udge/new-user | display
New user
username is missing
email is missing
email is missing
password is missing
password is missing
422

$ curl -XPOST udge/new-user -Fuser=$user | display
New user
email is missing
email is missing
password is missing
password is missing
422

$ curl -XPOST udge/new-user -Femail=u@example.com -Femail-confirmation=u@example.com | display
New user
username is missing
password is missing
password is missing
422

$ curl -XPOST udge/new-user -Fpassword=the-password -Fpassword-confirmation=the-password | display
New user
username is missing
email is missing
email is missing
422

$ curl -XPOST udge/new-user              -Femail=u@example.com -Femail-confirmation=u@example.com -Fpassword=the-password -Fpassword-confirmation=the-password | display
New user
username is missing
422

$ curl -XPOST udge/new-user -Fuser=$user                       -Femail-confirmation=u@example.com -Fpassword=the-password -Fpassword-confirmation=the-password | display
New user
email is missing
email is missing
422

$ curl -XPOST udge/new-user -Fuser=$user                                                          -Fpassword=the-password -Fpassword-confirmation=the-password | display
New user
email is missing
email is missing
422

$ curl -XPOST udge/new-user -Fuser=$user -Femail=u@example.com                                    -Fpassword=the-password -Fpassword-confirmation=the-password | display
New user
emails do not match
emails do not match
422

$ curl -XPOST udge/new-user -Fuser=$user -Femail=u@example.com -Femail-confirmation=u@example.com                         -Fpassword-confirmation=the-password | display
New user
password is missing
password is missing
422

$ curl -XPOST udge/new-user -Fuser=$user -Femail=u@example.com -Femail-confirmation=u@example.com                                                              | display
New user
password is missing
password is missing
422

$ curl -XPOST udge/new-user -Fuser=$user -Femail=u@example.com -Femail-confirmation=u@example.com -Fpassword=the-password                                      | display
New user
passwords do not match
passwords do not match
422

$ curl -XPOST udge/new-user -Fuser=$user -Femail=u@example.com -Femail-confirmation=w@example.com -Fpassword=the-password -Fpassword-confirmation=the-password | display
New user
emails do not match
emails do not match
422

$ curl -XPOST udge/new-user -Fuser=$user -Femail=u@example.com -Femail-confirmation=u@example.com -Fpassword=the-password -Fpassword-confirmation=A-password., | display
New user
passwords do not match
passwords do not match
422

$ curl -XPOST udge/new-user -Fuser=$user -Femail=u@example.com -Femail-confirmation=u@example.com -Fpassword=the-password -Fpassword-confirmation=the-password | display
User created
201

$ curl -XPOST udge/new-user -Fuser=$user -Femail=u@example.com -Femail-confirmation=u@example.com -Fpassword=the-password -Fpassword-confirmation=the-password | display
New user
username already exists (pick another)
409

$ curl -XPOST udge/new-user -Fuser=../../../../../bin/ls -Femail=u@example.com -Femail-confirmation=u@example.com -Fpassword=the-password -Fpassword-confirmation=the-password | display
New user
invalid characters: use lowercase English letters, digits, dashes (-) or underscores (_)
422

$ curl -XPOST udge/new-user -Fuser=$user -Femail=notanemail -Femail-confirmation=notanemail -Fpassword=the-password -Fpassword-confirmation=the-password | display
New user
invalid or unsupported email address
invalid or unsupported email address
422

$ curl -XPOST udge/new-user -Fuser=$user -Femail=.@... -Femail-confirmation=.@... -Fpassword=the-password -Fpassword-confirmation=the-password | display
New user
invalid or unsupported email address
invalid or unsupported email address
422

$ grep -R ".*" /etc/udge/users/$user/ | sed -e "s,.*/,," | sort
email:u@example.com
password:b3c3e62cc12d233b23442fc9cdd226ebe60f0549a6a7e9ad9e7b6a9520c393b5
