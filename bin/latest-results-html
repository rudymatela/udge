#!/bin/bash
#
# usage: ./bin/latest-results <user>
. /etc/udge/conf
errxit() {
	echo "$0, error: $@" >/dev/stderr
	echo "usage:" >/dev/stderr
	echo "  $0 <user>" >/dev/stderr
	exit 1
}
user="$1"
[ -n "$user" ] || errxit "missing <user> argument"
[ -d "$USERS_DIR/$user" ] || errxit "user not found"
dirname="`dirname $0`"
. "$dirname/../cgi-bin/utils"
html-header "Latest submissions for $1"
echo "<h2>Latest submissions for $1</h2>"
echo '<table class="table">'
echo '<tr><th>timestamp (UTC)</th><th>problem</th><th>language</th><th>score</th><th>reason</th></tr>'
"$dirname/latest-results" "$1" | sed -e 's,\([^ ]* [^ ]*\)  \([^ ]*\)\.\([^ ]*\)  [ ]*\([^ ]*\)[ ]*\(.*\),<tr><td>\1</td><td><a href="/\2">\2</a></td><td>\3</td><td>\4</td><td>\5</td></tr>,'
echo '</table>'
html-footer
